<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Plotly User Input - Funktion</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.5.0/math.min.js"></script> <!-- Importiert math.js -->
</head>
<body>

<h3>Gib eine mathematische Funktion ein (z.B. 3^x + 9 + 9^x):</h3>
<input type="text" id="userInput" placeholder="Funktion eingeben">
<br><br>
<!-- Auswahl für 2D oder 3D -->
<label for="plotType">Wähle den Plottyp:</label>
<select id="plotType">
    <option value="2d">2D</option>
    <option value="3d">3D</option>
</select>
<br><br>
<button onclick="plotFunction()">Plot anzeigen</button>

<div id="plotlyDiv" style="height: 500px; width: 100%;"></div>

<script>
    function plotFunction() {
        var funcString = document.getElementById("userInput").value;
        var plotType = document.getElementById("plotType").value;

        // Sicherstellen, dass eine Eingabe vorhanden ist
        if (!funcString) {
            alert("Bitte gib eine Funktion ein!");
            return;
        }

        // Arrays für die x-, y- und z-Werte
        var x = [];
        var y = [];
        var z = [];

        // Berechne die Funktionswerte für x von -10 bis 10
        for (var i = -10; i <= 10; i++) {
            x.push(i);
            try {
                // Berechne den Funktionswert aus dem eingegebenen String
                var result = math.evaluate(funcString, {x: i});
                y.push(result);
                if (plotType === '3d') {
                    // Für den 3D-Plot nehmen wir y als z-Werte
                    z.push(result);
                }
            } catch (error) {
                alert("Fehler bei der Berechnung der Funktion: " + error.message);
                return;
            }
        }

        var data;

        // Wenn 2D ausgewählt ist, nutzen wir den vorhandenen Code für den 2D-Plot
        if (plotType === '2d') {
            data = [{
                x: x,
                y: y,
                mode: 'lines+markers',
                type: 'scatter',
                name: funcString
            }];
        } else if (plotType === '3d') {
            // Für den 3D-Plot müssen wir eine Surface- oder Scatter3d-Darstellung verwenden
            data = [{
                x: x,
                y: y,
                z: z,
                mode: 'markers',
                type: 'scatter3d',
                name: funcString
            }];
        }

        // Layout für den Plot
        var layout = {
            title: `Plot der Funktion: ${funcString}`,
            xaxis: {
                title: 'x-Werte'
            },
            yaxis: {
                title: 'Funktionswerte'
            }
        };

        if (plotType === '3d') {
            layout.scene = {
                xaxis: { title: 'x-Werte' },
                yaxis: { title: 'y-Werte' },
                zaxis: { title: 'Funktionswerte' }
            };
        }

        // Plotly Diagramm erstellen
        Plotly.newPlot('plotlyDiv', data, layout);
    }
</script>

</body>
</html>
